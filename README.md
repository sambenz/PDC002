# Witrn PDC002 Firmware Loader

## Introduction
Reads and writes the Witrn PDC002 Firmware on Linux. 

The firmware files are generated by reading
them back from the device and compared to the traced USB HID traffic using a Saleae Logic Pro 8
analyzer.

## Basic Communication
The cable enters HID mode through the small cable programmer. While the programmer also has an
HID interface, the communication is done directly to the cable. Messages to and from 
the device are always 64 bytes long. The actual payload size varies depending on the command
and is specified inside the protocol.

## Protocol

Message:
```
2 bytes header
6 bytes timestamp
1 byte command
1 byte payload size (differs in the reset command)
n bytes payload
1 byte chcksum (addition of bytes 8-61)
1 byte checksum (addition of bytes 0-61)
```

Timestamp (seems to be ignored by the device):
```
1 byte second (absolute)
1 byte millisecond (absolute)
1 byte microsecond (absolute)
1 byte 10th second (relative; rolls to 0 at first byte 255)
1 byte milliscond (relative; rolls to 0 at first byte 255)
1 byte microsecond (relative; rolls to 0 at first byte 255)
```

Command:
```
2: ack (response only, various payload)
3: upgrade mode (0 payload)
4: end write (0 payload)
5: start write (0 payload)
8: delete ([0, addr, 0, 8])
9: write ([addr, addr, 0, 8, length, data, ...)]
10: read ([0, addr, 0, 8, length])
11: read bulk ([0, addr, 0, 8, 0, 4])
23: reset (special, see code)
```

## Additional Information
https://github.com/JaCzekanski/pdc-control/blob/master/src/main.cpp

https://wiki.cuvoodoo.info/doku.php?id=web-u2
